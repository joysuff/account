import"./request-DPtWsdmB.js";/* empty css                   *//* empty css                     *//* empty css                 *//* empty css                 *//* empty css               *//* empty css               *//* empty css                  */import{g as K,d as Q,u as W,c as X}from"./categories-58bDfnwB.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as c,a as ee,J as B,p as te,c as i,o as r,b as s,d as t,w as o,k as oe,L as le,a2 as ae,g as y,l as d,E as se,M as ne,Y as ie,x as _,N as re,O as S,P as T,f as de,h as ue,i as ce,_ as pe,$ as me,G as _e,n as $}from"./index-B4p3Y3uI.js";const fe={class:"categories"},ge={class:"page-header"},ve={class:"card"},ye={class:"card-header"},Ce={key:0,class:"loading-container"},ke={key:1,class:"empty-state"},xe={key:2,class:"category-list"},Ee={class:"category-info"},we={class:"category-name"},be={class:"category-actions"},Ve={class:"card"},he={class:"card-header"},Be={key:0,class:"loading-container"},$e={key:1,class:"empty-state"},Me={key:2,class:"category-list"},De={class:"category-info"},Fe={class:"category-name"},Re={class:"category-actions"},ze={__name:"Categories",setup(Ie){const f=c(!1),C=c(!1),p=c(!1),k=c([]),g=c(null),v=c(),n=ee({name:"",type:"expense"}),O={name:[{required:!0,message:"请输入分类名称",trigger:"blur"},{min:1,max:20,message:"分类名称长度在1到20个字符",trigger:"blur"}],type:[{required:!0,message:"请选择分类类型",trigger:"change"}]},x=B(()=>!!g.value),E=B(()=>k.value.filter(l=>l.type==="income")),w=B(()=>k.value.filter(l=>l.type==="expense")),b=async()=>{f.value=!0;try{const{data:l}=await K();k.value=l||[]}catch(l){console.error("获取分类失败:",l)}finally{f.value=!1}},M=l=>{g.value=l,n.name=l.name,n.type=l.type,p.value=!0},D=async l=>{try{await _e.confirm(`确定要删除分类"${l.name}"吗？删除后相关记录将无法正常显示。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await Q(l.id),$.success("删除成功"),b()}catch(e){e!=="cancel"&&console.error("删除失败:",e)}},V=()=>{var l;p.value=!1,g.value=null,n.name="",n.type="expense",(l=v.value)==null||l.clearValidate()},P=async()=>{if(v.value)try{await v.value.validate(),C.value=!0,x.value?(await W(g.value.id,n),$.success("更新成功")):(await X(n),$.success("添加成功")),V(),b()}catch(l){console.error("提交失败:",l)}finally{C.value=!1}};return te(()=>{b()}),(l,e)=>{const U=y("Plus"),m=se,u=oe,F=ie,R=re,z=y("FolderOpened"),q=y("Money"),I=ne,G=y("ShoppingCart"),A=le,J=ce,L=ue,N=me,Y=pe,j=de,H=ae;return r(),i("div",fe,[s("div",ge,[e[5]||(e[5]=s("h1",{class:"page-title"},"分类管理",-1)),t(u,{type:"primary",onClick:e[0]||(e[0]=a=>p.value=!0)},{default:o(()=>[t(m,null,{default:o(()=>[t(U)]),_:1}),e[4]||(e[4]=d(" 添加分类 ",-1))]),_:1})]),t(A,{gutter:20},{default:o(()=>[t(I,{span:12},{default:o(()=>[s("div",ve,[s("div",ye,[e[6]||(e[6]=s("h3",null,"收入分类",-1)),t(F,{type:"success"},{default:o(()=>[d(_(E.value.length)+" 个",1)]),_:1})]),f.value?(r(),i("div",Ce,[t(R)])):E.value.length===0?(r(),i("div",ke,[t(m,null,{default:o(()=>[t(z)]),_:1}),e[7]||(e[7]=s("p",null,"暂无收入分类",-1))])):(r(),i("div",xe,[(r(!0),i(S,null,T(E.value,a=>(r(),i("div",{key:a.id,class:"category-item"},[s("div",Ee,[t(m,{class:"category-icon income"},{default:o(()=>[t(q)]),_:1}),s("span",we,_(a.name),1)]),s("div",be,[t(u,{type:"primary",size:"small",onClick:h=>M(a)},{default:o(()=>[...e[8]||(e[8]=[d(" 编辑 ",-1)])]),_:1},8,["onClick"]),t(u,{type:"danger",size:"small",onClick:h=>D(a)},{default:o(()=>[...e[9]||(e[9]=[d(" 删除 ",-1)])]),_:1},8,["onClick"])])]))),128))]))])]),_:1}),t(I,{span:12},{default:o(()=>[s("div",Ve,[s("div",he,[e[10]||(e[10]=s("h3",null,"支出分类",-1)),t(F,{type:"danger"},{default:o(()=>[d(_(w.value.length)+" 个",1)]),_:1})]),f.value?(r(),i("div",Be,[t(R)])):w.value.length===0?(r(),i("div",$e,[t(m,null,{default:o(()=>[t(z)]),_:1}),e[11]||(e[11]=s("p",null,"暂无支出分类",-1))])):(r(),i("div",Me,[(r(!0),i(S,null,T(w.value,a=>(r(),i("div",{key:a.id,class:"category-item"},[s("div",De,[t(m,{class:"category-icon expense"},{default:o(()=>[t(G)]),_:1}),s("span",Fe,_(a.name),1)]),s("div",Re,[t(u,{type:"primary",size:"small",onClick:h=>M(a)},{default:o(()=>[...e[12]||(e[12]=[d(" 编辑 ",-1)])]),_:1},8,["onClick"]),t(u,{type:"danger",size:"small",onClick:h=>D(a)},{default:o(()=>[...e[13]||(e[13]=[d(" 删除 ",-1)])]),_:1},8,["onClick"])])]))),128))]))])]),_:1})]),_:1}),t(H,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=a=>p.value=a),title:x.value?"编辑分类":"添加分类",width:"400px",onClose:V},{footer:o(()=>[t(u,{onClick:V},{default:o(()=>[...e[16]||(e[16]=[d("取消",-1)])]),_:1}),t(u,{type:"primary",loading:C.value,onClick:P},{default:o(()=>[d(_(x.value?"更新":"添加"),1)]),_:1},8,["loading"])]),default:o(()=>[t(j,{ref_key:"formRef",ref:v,model:n,rules:O,"label-width":"80px"},{default:o(()=>[t(L,{label:"分类名称",prop:"name"},{default:o(()=>[t(J,{modelValue:n.name,"onUpdate:modelValue":e[1]||(e[1]=a=>n.name=a),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),t(L,{label:"分类类型",prop:"type"},{default:o(()=>[t(Y,{modelValue:n.type,"onUpdate:modelValue":e[2]||(e[2]=a=>n.type=a)},{default:o(()=>[t(N,{label:"income"},{default:o(()=>[...e[14]||(e[14]=[d("收入",-1)])]),_:1}),t(N,{label:"expense"},{default:o(()=>[...e[15]||(e[15]=[d("支出",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Ye=Z(ze,[["__scopeId","data-v-3bb2af24"]]);export{Ye as default};
