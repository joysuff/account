# 记账系统 API 文档

## 目录

- [用户管理](#用户管理)
  - [用户注册](#用户注册)
  - [用户登录](#用户登录)
  - [获取用户信息](#获取用户信息)
- [分类管理](#分类管理)
  - [获取分类列表](#获取分类列表)
  - [新增分类](#新增分类)
  - [修改分类](#修改分类)
  - [删除分类](#删除分类)
- [记账管理](#记账管理)
  - [新增账目](#新增账目)
  - [编辑账目](#编辑账目)
  - [删除账目](#删除账目)
  - [查询账目列表](#查询账目列表)
  - [获取账目详情](#获取账目详情)
  - [导出账目记录](#导出账目记录)
- [统计分析](#统计分析)
  - [日统计](#日统计)
  - [月统计](#月统计)
  - [分类统计](#分类统计)
  - [趋势统计](#趋势统计)
- [AI分析](#ai分析)
  - [日账单分析](#日账单分析)
  - [月账单分析](#月账单分析)
  - [近期账单分析](#近期账单分析)
- [周期性支付管理](#周期性支付管理)
  - [获取周期性支付列表](#获取周期性支付列表)
  - [新增周期性支付](#新增周期性支付)
  - [修改周期性支付](#修改周期性支付)
  - [删除周期性支付](#删除周期性支付)
  - [获取周期性支付详情](#获取周期性支付详情)
  - [启用/禁用周期性支付定时任务](#启用禁用周期性支付定时任务)
  - [执行定时任务](#执行定时任务)
  - [启动/停止定时任务](#启动或停止定时任务)

## 通用说明

### 请求格式

- 请求体为json的接口需要在请求头中添加`Content-Type: application/json`
- 认证接口需在请求头中添加：`Authorization: Bearer {token}`（登录注册接口不需要添加）

### 响应格式

所有API响应均为JSON格式，包含以下字段：
成功响应
```json
{
  "code": 200,      // 状态码
  "msg": "成功消息", // 提示信息
  "data": {}        // 返回数据，可能为null
}
```
失败响应
```json
{
  "code": 400,      // 状态码
  "msg": "失败消息", // 提示信息
}
```

### 错误码说明

| 错误码 | 说明 |
| ------ | ---- |
| 200    | 成功 |
| 201    | 创建成功 |
| 400    | 请求参数错误 |
| 401    | 未授权或授权失败 |
| 403    | 权限不足 |
| 404    | 资源不存在 |
| 409    | 资源冲突 |
| 422    | 请求内容错误 |
| 500    | 服务器内部错误 |

## 用户管理

### 用户注册

**接口描述**：注册新用户

**请求方法**：`POST`

**请求路径**：`/api/register`

**请求参数**：

| 参数名   | 类型   | 必填 | 说明     |
| -------- | ------ | ---- | -------- |
| username | string | 是   | 用户名   |
| password | string | 是   | 用户密码 |

**请求示例**：

```json
{
  "username": "testuser",
  "password": "password123"
}
```

**响应示例**：

```json
{
  "code": 201,
  "msg": "注册成功",
  "data": {
    "userId": 1
  }
}
```

**错误情况**：
- 400: 用户名或密码不能为空
- 409: 用户名已存在
- 500: 注册失败

### 用户登录

**接口描述**：用户登录获取令牌

**请求方法**：`POST`

**请求路径**：`/api/login`

**请求参数**：

| 参数名   | 类型   | 必填 | 说明     |
| -------- | ------ | ---- | -------- |
| username | string | 是   | 用户名   |
| password | string | 是   | 用户密码 |

**请求示例**：

```json
{
  "username": "testuser",
  "password": "password123"
}
```

**响应示例**：

```json
{
  "code": 200,
  "msg": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

**错误情况**：
- 400: 用户名或密码不能为空
- 401: 用户名或密码错误
- 500: 登录失败

### 获取用户信息

**接口描述**：获取当前登录用户信息

**请求方法**：`GET`

**请求路径**：`/api/profile`

**请求头**：需要包含授权令牌

**响应示例**：

```json
{
  "code": 200,
  "msg": "获取用户信息成功",
  "data": {
    "id": 1,
    "username": "testuser",
    "created_at": "2025-08-27T12:00:00Z"
  }
}
```

**错误情况**：
- 404: 用户不存在
- 500: 获取用户信息失败

## 分类管理

### 获取分类列表

**接口描述**：获取用户的所有分类

**请求方法**：`GET`

**请求路径**：`/api/categories`

**请求头**：需要包含授权令牌

**响应示例**：

```json
{
  "code": 200,
  "msg": "获取成功",
  "data": [
    {
      "id": 1,
      "name": "餐饮",
      "type": "expense"
    },
    {
      "id": 2,
      "name": "工资",
      "type": "income"
    }
  ]
}
```

**错误情况**：
- 404: 没有数据
- 500: 获取失败

### 新增分类

**接口描述**：创建新的收支分类

**请求方法**：`POST`

**请求路径**：`/api/categories`

**请求头**：需要包含授权令牌

**请求参数**：

| 参数名 | 类型   | 必填 | 说明                           |
| ------ | ------ | ---- | ------------------------------ |
| name   | string | 是   | 分类名称                       |
| type   | string | 是   | 分类类型（income或expense）    |

**请求示例**：

```json
{
  "name": "交通",
  "type": "expense"
}
```

**响应示例**：

```json
{
  "code": 200,
  "msg": "添加成功",
  "data": {
    "id": 3,
    "name": "交通",
    "type": "expense"
  }
}
```

**错误情况**：
- 400: 分类名和类型不能为空
- 409: 分类已存在
- 500: 添加失败


### 修改分类

**接口描述**：修改已有分类

**请求方法**：`PUT`

**请求路径**：`/api/categories/:id`

**请求头**：需要包含授权令牌

**路径参数**：

| 参数名 | 类型   | 必填 | 说明     |
| ------ | ------ | ---- | -------- |
| id     | number | 是   | 分类ID   |

**请求参数**：

| 参数名 | 类型   | 必填 | 说明                           |
| ------ | ------ | ---- | ------------------------------ |
| name   | string | 是   | 分类名称                       |
| type   | string | 是   | 分类类型（income或expense）    |

**请求示例**：

```json
{
  "name": "公共交通",
  "type": "expense"
}
```

**响应示例**：

```json
{
  "code": 200,
  "msg": "修改成功",
  "data": {
    "id": 3,
    "name": "公共交通",
    "type": "expense"
  }
}
```

**错误情况**：
- 400: 分类名称和类型不能为空
- 403: 无权限修改
- 404: 要修改的分类不存在
- 409: 分类名称已存在
- 500: 修改失败或无权限

### 删除分类

**接口描述**：删除指定分类

**请求方法**：`DELETE`

**请求路径**：`/api/categories/:id`

**请求头**：需要包含授权令牌

**路径参数**：

| 参数名 | 类型   | 必填 | 说明     |
| ------ | ------ | ---- | -------- |
| id     | number | 是   | 分类ID   |

**响应示例**：

```json
{
  "code": 200,
  "msg": "删除成功",
  "data": {
     "id": 14
  }
}
```

**错误情况**：
- 500: 删除失败或无权限

## 记账管理

### 新增账目

**接口描述**：添加新的收支记录

**请求方法**：`POST`

**请求路径**：`/api/records`

**请求头**：需要包含授权令牌

**请求参数**：

| 参数名      | 类型   | 必填 | 说明                        |
| ----------- | ------ | ---- | --------------------------- |
| category_id | number | 是   | 分类ID                      |
| amount      | number | 是   | 金额                        |
| type        | string | 是   | 类型（income或expense）     |
| date        | string | 是   | 日期（YYYY-MM-DD格式）      |
| remark      | string | 否   | 备注                        |

**请求示例**：

```json
{
  "category_id": 1,
  "amount": 100.50,
  "type": "expense",
  "date": "2025-08-27",
  "remark": "午餐费用"
}
```

**响应示例**：

```json
{
  "code": 200,
  "msg": "添加成功",
  "data": {
    "id": 1
  }
}
```

**错误情况**：
- 400: 参数不完整
- 404: 分类不存在
- 422: 分类类型与账目类型不一致
- 500: 添加失败

### 编辑账目

**接口描述**：修改已有账目记录

**请求方法**：`PUT`

**请求路径**：`/api/records/:id`

**请求头**：需要包含授权令牌

**路径参数**：

| 参数名 | 类型   | 必填 | 说明     |
| ------ | ------ | ---- | -------- |
| id     | number | 是   | 记录ID   |

**请求参数**：

| 参数名      | 类型   | 必填 | 说明                        |
| ----------- | ------ | ---- | --------------------------- |
| category_id | number | 是   | 分类ID                      |
| amount      | number | 是   | 金额                        |
| type        | string | 是   | 类型（income或expense）     |
| date        | string | 是   | 日期（YYYY-MM-DD格式）      |
| remark      | string | 否   | 备注                        |

**请求示例**：

```json
{
  "category_id": 1,
  "amount": 120.50,
  "type": "expense",
  "date": "2025-08-27",
  "remark": "午餐和下午茶"
}
```

**响应示例**：

```json
{
  "code": 200,
  "msg": "修改成功",
  "data": null
}
```

**错误情况**：
- 400: 参数不完整
- 404: 记录不存在或分类不存在
- 422: 分类类型与账目类型不一致
- 500: 修改失败或无权限

### 删除账目

**接口描述**：删除指定账目记录

**请求方法**：`DELETE`

**请求路径**：`/api/records/:id`

**请求头**：需要包含授权令牌

**路径参数**：

| 参数名 | 类型   | 必填 | 说明     |
| ------ | ------ | ---- | -------- |
| id     | number | 是   | 记录ID   |

**响应示例**：

```json
{
  "code": 200,
  "msg": "删除成功",
  "data": null
}
```

**错误情况**：
- 500: 删除失败或无权限

### 查询账目列表

**接口描述**：分页查询账目记录

**请求方法**：`GET`

**请求路径**：`/api/records`

**请求头**：需要包含授权令牌

**查询参数**：

| 参数名   | 类型   | 必填 | 说明                   |
| -------- | ------ | ---- | ---------------------- |
| start    | string | 否   | 开始日期（YYYY-MM-DD） |
| end      | string | 否   | 结束日期（YYYY-MM-DD） |
| page     | number | 否   | 页码，默认1            |
| pageSize | number | 否   | 每页条数，默认10       |

**响应示例**：

```json
{
  "code": 200,
  "msg": "获取成功",
  "data": {
    "total": 25,
    "page": 1,
    "pageSize": 10,
    "totalPages": 3,
    "records": [
      {
        "id": 1,
        "category": {
          "id": 1,
          "name": "餐饮",
          "type": "expense"
        },
        "amount": 100.50,
        "type": "expense",
        "date": "2025-08-27",
        "remark": "午餐费用"
      },
      // 更多记录...
    ]
  }
}
```

**错误情况**：
- 404: 没有数据
- 500: 获取失败

### 获取账目详情

**接口描述**：获取单条账目记录详情

**请求方法**：`GET`

**请求路径**：`/api/records/:id`

**请求头**：需要包含授权令牌

**路径参数**：

| 参数名 | 类型   | 必填 | 说明     |
| ------ | ------ | ---- | -------- |
| id     | number | 是   | 记录ID   |

**响应示例**：

```json
{
  "code": 200,
  "msg": "获取成功",
  "data": {
    "id": 10,
    "category": {
        "id": 9,
        "name": "工资",
        "type": "income"
    },
    "amount": "8000.01",
    "type": "income",
    "date": "2025-07-15",
    "remark": "工资工资"
  }
}
```

**错误情况**：
- 400: 参数不完整
- 404: 记录不存在
- 500: 获取失败

### 导出账目记录

**接口描述**：导出指定时间范围内的账目记录为CSV文件

**请求方法**：`GET`

**请求路径**：`/api/records/export`

**请求头**：需要包含授权令牌

**查询参数**：

| 参数名 | 类型   | 必填 | 说明                   |
| ------ | ------ | ---- | ---------------------- |
| start  | string | 是   | 开始日期（YYYY-MM-DD） |
| end    | string | 是   | 结束日期（YYYY-MM-DD） |

**响应**：

返回CSV文件下载，文件名格式为：`records_YYYY-MM-DD HH-MM-SS.csv`

CSV文件包含以下字段：
- 日期
- 分类
- 金额
- 类型
- 备注

**错误情况**：
- 400: 参数不完整
- 404: 没有数据
- 500: 导出失败

## 统计分析

### 日统计

**接口描述**：获取指定日期的收支统计（含明细和汇总）

**请求方法**：`GET`

**请求路径**：`/api/statistics/daily`

**请求头**：需要包含授权令牌

**查询参数**：

| 参数名 | 类型   | 必填 | 说明                   |
| ------ | ------ | ---- | ---------------------- |
| date   | string | 是   | 日期（YYYY-MM-DD）     |

**响应示例**：

```json
{
  "code": 200,
  "msg": "获取成功",
  "data": {
    "income": 0,
    "expense": 20,
    "records": [
      {
        "id": 18,
        "category": {
          "id": 11,
          "name": "衣食住行",
          "type": "expense"
        },
        "amount": "20.00",
        "type": "expense",
        "date": "2024-06-01",
        "remark": "11"
      },
      // 更多数据
    ]
  }
}
```

**错误情况**：
- 400: 缺少日期参数
- 404: 指定日期没有数据
- 500: 获取失败

### 月统计

**接口描述**：获取指定月份的收支总额

**请求方法**：`GET`

**请求路径**：`/api/statistics/monthly`

**请求头**：需要包含授权令牌

**查询参数**：

| 参数名 | 类型   | 必填 | 说明                |
| ------ | ------ | ---- | ------------------- |
| month  | string | 是   | 月份（YYYY-MM）     |

**响应示例**：

```json
{
  "code": 200,
  "msg": "获取成功",
  "data": {
    "income": 5000,
    "expense": 3000
  }
}
```

**错误情况**：
- 400: 缺少月份参数
- 500: 获取失败

### 分类统计

**接口描述**：获取指定月份按分类的消费占比（饼图数据）

**请求方法**：`GET`

**请求路径**：`/api/statistics/category`

**请求头**：需要包含授权令牌

**查询参数**：

| 参数名 | 类型   | 必填 | 说明                           |
| ------ | ------ | ---- | ------------------------------ |
| month  | string | 是   | 月份（YYYY-MM）                |
| type   | string | 是   | 类型（income或expense）        |

**响应示例**：

```json
{
  "code": 200,
  "msg": "获取成功",
  "data": [
    {
      "category": "餐饮",
      "amount": 1500
    },
    {
      "category": "交通",
      "amount": 900
    },
    // 更多数据
  ]
}
```

**错误情况**：
- 400: 缺少月份或类型参数
- 404: 指定月份没有数据
- 500: 获取失败

### 趋势统计

**接口描述**：获取近N天收支趋势

**请求方法**：`GET`

**请求路径**：`/api/statistics/trend`

**请求头**：需要包含授权令牌

**查询参数**：

| 参数名 | 类型   | 必填 | 说明                     |
| ------ | ------ | ---- | ------------------------ |
| days   | number | 否   | 天数，默认7              |

**响应示例**：

```json
{
  "code": 200,
  "msg": "获取成功",
  "data": [
    {
      "date": "2025-08-21",
      "income": 500,
      "expense": 300
    },
    {
      "date": "2025-08-22",
      "income": 0,
      "expense": 400
    },
    // 更多日期数据...
  ]
}
```

**错误情况**：
- 400: 最近天数不能为负数
- 404: 最近指定天数没有数据
- 500: 获取失败

## AI分析

### 日账单分析

**接口描述**：AI分析指定日期的收支情况

**请求方法**：`GET`

**请求路径**：`/api/analysisDaily`

**请求头**：需要包含授权令牌

**查询参数**：

| 参数名 | 类型   | 必填 | 说明                   |
| ------ | ------ | ---- | ---------------------- |
| date   | string | 是   | 日期（YYYY-MM-DD）     |

**响应格式**：Server-Sent Events (SSE)

**事件类型**：

| 事件类型 | 说明                 | 数据格式                       |
| -------- | -------------------- | ------------------------------ |
| message  | 系统消息             | `{"content": "消息内容"}`      |
| analysis | 分析内容（流式返回） | `{"content": "分析内容片段"}`  |
| error    | 错误信息             | `{"message": "错误信息"}`      |
| end      | 分析结束             | `{"content": "完整分析内容"}`  |

**错误情况**：
- 日期参数缺失：通过error事件返回 `{"message": "日期参数缺失"}`
- 指定日期无数据：通过message事件返回 `{"content": "YYYY-MM-DD日无数据"}`
- 分析失败：通过error事件返回相关错误信息

### 月账单分析

**接口描述**：AI分析指定月份的收支情况

**请求方法**：`GET`

**请求路径**：`/api/analysisMonthly`

**请求头**：需要包含授权令牌

**查询参数**：

| 参数名 | 类型   | 必填 | 说明                   |
| ------ | ------ | ---- | -------------------|
| month  | string |  是  | 月份（YYYY-MM）        |

**响应格式**：Server-Sent Events (SSE)

**事件类型**：

| 事件类型 | 说明                 | 数据格式                       |
| -------- | -------------------- | ------------------------------ |
| message  | 系统消息             | `{"content": "消息内容"}`      |
| analysis | 分析内容（流式返回） | `{"content": "分析内容片段"}`  |
| error    | 错误信息             | `{"message": "错误信息"}`      |
| end      | 分析结束             | `{"content": "完整分析内容"}`  |

**错误情况**：
- 月份参数缺失：通过error事件返回 `{"message": "缺少月份参数"}`
- 指定月份无数据：通过message事件返回 `{"content": "YYYY-MM月无收入支出账单"}`
- 分析失败：通过error事件返回相关错误信息


### 近N天账单分析

**接口描述**：AI分析最近N天的收支情况

**请求方法**：`GET`

**请求路径**：`/api/analysisRecent`

**请求头**：需要包含授权令牌

**查询参数**：

| 参数名 | 类型   | 必填 | 说明                   |
| ------ | ------ | ---- | -------------------|
| days  | number |  是  | 天数（默认7）        |

**响应格式**：Server-Sent Events (SSE)

**事件类型**：

| 事件类型 | 说明                 | 数据格式                       |
| -------- | -------------------- | ------------------------------ |
| message  | 系统消息             | `{"content": "消息内容"}`      |
| analysis | 分析内容（流式返回） | `{"content": "分析内容片段"}`  |
| error    | 错误信息             | `{"message": "错误信息"}`      |
| end      | 分析结束             | `{"content": "完整分析内容"}`  |

**错误情况**：
- 最近天数不能为负数：通过error事件返回 `{"message": "最近天数不能为负数"}`
- 最近指定天数没有数据：通过message事件返回 `{"content": "最近N天无数据"}`
- 分析失败：通过error事件返回相关错误信息


## 周期性支付管理

### 获取周期性支付列表

**接口描述**：获取用户的所有周期性支付记录

**请求方法**：`GET`

**请求路径**：`/api/repayments`

**请求头**：需要包含授权令牌

**响应示例**：

```json
{
  "code": 200,
  "msg": "查询成功",
  "data": [
    {
      "id": 17,
      "user_id": 1,
      "category_id": 11,
      "item": "测试",
      "amount": "100.00",
      "day_of_month": 12,
      "email": "3384214519@qq.com",
      "enabled": 1,
      "last_reminded_at": null,
      "created_at": "2025-09-13 23:37:56",
      "status": "定时任务未创建"
    },
    // 更多记录...
  ]
}
```
> status和taskStatus（后面接口返回）都表示定时任务状态，创建之后会有后面几种状态，idle表示已创建等待执行，running表示运行中，stopped表示暂停,destroyed表示已销毁（不会返回这个状态）
**错误情况**：
- 404: 没有数据
- 500: 获取失败

### 新增周期性支付

**接口描述**：创建新的周期性支付记录并创建定时任务（enabled为1时）

**请求方法**：`POST`

**请求路径**：`/api/repayments`

**请求头**：需要包含授权令牌

**请求参数**：

| 参数名      | 类型   | 必填 | 说明                                 |
| ----------- | ------ | ---- | ------------------------------------ |
| category_id | number | 是   | 分类ID                               |
| amount      | number | 是   | 金额                                 |
| item        | string | 是   | 名称                                 |
| day_of_month | number | 是   | 每月提醒时间                          |
| email        | string | 是   | 推送邮箱                             |
| enabled      | number | 是   | 是否启用邮件推送，1表示启用，0表示禁用（数据库默认为1） |

**请求示例**：

```json
{
  "category_id": 11,
  "item": "测试2",
  "amount": 1000,
  "day_of_month": 12,
  "email": "3384214519@qq.com",
  "enabled": 1
}
```

**响应示例**：

```json
{
  "code": 201,
  "msg": "新增成功",
  "data": {
    "id": 18,
    "taskStatus": "idle" //定时任务状态，上面有解释
  }
}
```
**错误情况**：
- 400: 参数不完整或不合法
- 500: 添加失败

### 修改周期性支付

**接口描述**：修改已有周期性支付记录

**请求方法**：`PUT`

**请求路径**：`/api/repayments/:id`

**请求头**：需要包含授权令牌

**路径参数**：

| 参数名 | 类型   | 必填 | 说明     |
| ------ | ------ | ---- | -------- |
| id     | number | 是   | 记录ID   |

**请求参数**：

| 参数名      | 类型   | 必填 | 说明                                 |
| ----------- | ------ | ---- | ------------------------------------ |
| category_id | number | 是   | 分类ID                               |
| amount      | number | 是   | 金额                                 |
| item        | string | 是   | 名称                                 |
| day_of_month | number | 是   | 每月提醒时间                          |
| email        | string | 是   | 推送邮箱                             |

**请求示例**：

```json
{
  "category_id": 11,
  "item": "测试111",
  "amount": 100,
  "day_of_month": 12,
  "email": "3384214519@qq.com"
}
```

**响应示例**：

```json
{
  "code": 200,
  "msg": "更新成功",
  "data": {
    "id": 19,
    "oldTaskStatus": "定时任务已删除", // 删除旧的任务显示其操作结果
    "newTaskStatus": "idle" // 新的任务状态
  }
}
```

**错误情况**：
- 400: 参数不完整或不合法
- 404: 记录不存在
- 500: 修改失败或无权限

### 删除周期性支付

**接口描述**：删除指定周期性支付记录并销毁定时任务

**请求方法**：`DELETE`

**请求路径**：`/api/repayments/:id`

**请求头**：需要包含授权令牌

**路径参数**：

| 参数名 | 类型   | 必填 | 说明     |
| ------ | ------ | ---- | -------- |
| id     | number | 是   | 记录ID   |

**响应示例**：

```json
{
  "code": 200,
  "msg": "删除成功",
  "data": {
    "id": 19,
    "taskStatus": "定时任务已删除" // 定时任务删除结果
  }
}
```

**错误情况**：
- 500: 删除失败

### 获取周期性支付详情

**接口描述**：获取单条周期性支付记录详情

**请求方法**：`GET`

**请求路径**：`/api/repayments/:id`

**请求头**：需要包含授权令牌

**路径参数**：

| 参数名 | 类型   | 必填 | 说明     |
| ------ | ------ | ---- | -------- |
| id     | number | 是   | 记录ID   |

**响应示例**：

```json
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "id": 17,
    "category_id": 11,
    "item": "测试",
    "amount": "100.00",
    "day_of_month": 12,
    "email": "3384214519@qq.com",
    "enabled": 1,
    "last_reminded_at": null,
    "created_at": "2025-09-13 23:37:56",
    "status": "定时任务未创建"
  }
}
```

**错误情况**：
- 400: 参数不完整
- 404: 记录不存在
- 500: 获取失败

### 启用/禁用周期性支付定时任务

**接口描述**：启用或禁用定时任务（修改数据库enabled字段）

**请求方法**：`PUT`

**请求路径**：`/api/repayments/enabled/:id`

**请求头**：需要包含授权令牌

**路径参数**：

| 参数名 | 类型   | 必填 | 说明     |
| ------ | ------ | ---- | -------- |
| id     | number | 是   | 记录ID   |

**请求参数**：

| 参数名  | 类型    | 必填 | 说明                 |
| ------- | ------- | ---- | -------------------- |
| enabled | number  | 是   | 1启用，0禁用  |

**请求示例**：

```json
{
  "enabled": 1
}
```

**响应示例**：

```json
{
  "code": 200,
  "msg": "更新成功",  // 更新数据库enabled字段成功
  "data": {
    "id": 17,
    "taskStatus": "idle"  // 定时任务状态，如果这里传的enabled是0，状态会显示“定时任务已删除”或“未找到定时任务”
  }
}
```

**错误情况**：
- 400: 参数不完整
- 404: 记录不存在
- 500: 操作失败

### 执行定时任务

**接口描述**：手动执行定时任务

**请求方法**：`POST`

**请求路径**：`/api/repayments/execute/:id`

**请求头**：需要包含授权令牌

**路径参数**：

| 参数名 | 类型   | 必填 | 说明     |
| ------ | ------ | ---- | -------- |
| id     | number | 是   | 记录ID   |

**响应示例**：

```json
{
  "code": 200,
  "msg": "执行成功",
  "data": {
    "id": 17,
    "taskStatus": "定时任务已执行"
  }
}
```

**错误情况**：
- 404: 定时任务不存在
- 500: 执行失败


### 启动或停止定时任务

**接口描述**：手动启动或停止定时任务

**请求方法**：`POST`

**请求路径**：`/api/repayments/startstop/:id`

**请求头**：需要包含授权令牌

**路径参数**：

| 参数名 | 类型   | 必填 | 说明     |
| ------ | ------ | ---- | -------- |
| id     | number | 是   | 记录ID   |

**请求参数**：

| 参数名  | 类型    | 必填 | 说明                 |
| ------- | ------- | ---- | -------------------- |
| action  | number  | 是   | 1启动，0停止  |

**响应示例**：

```json
{
  "code": 200,
  "msg": "停止成功",
  "data": {
    "id": 17,
    "taskStatus": "定时任务已停止" // action为0时的响应；若action为1，一般会显示idle（启动了等待条件符合执行）
  }
}
```
**错误情况**：
- 404: 定时任务不存在
- 500: 操作失败